SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

--[dbo].[AP2SP_PrintLabel] '10062','''21B04'',''29C08'',''30A11''','','1'
--[dbo].[AP2SP_PrintLabel] '10089','''03NW01'',''03NW02'',''03NW06'',''03NW10'',''03NW13'',''03SW01'',''03SW02'',''03SW03'',''03SW04'',''03SW07'',''03SW12'',''03SW15'',''03SW16'',''03SW17'',''03SW18'',''03SW19'',''03SW20'',''04NW01'',''04NW02'',''04NW06'',''04NW12'',''04NW13'',''04SW01'',''04SW02'',''04SW03'',''04SW04'',''04SW05'',''04SW06'',''04SW07'',''04SW09'',''04SW11'',''04SW12'',''04SW14'',''04SW15'',''04SW16'',''04SW17'',''04SW18'',''04SW19'',''04SW20'',''05NW01'',''05NW02'',''05NW03'',''05NW04'',''05NW05'',''05NW06'',''05NW13'',''05SW01'',''05SW02'',''05SW03'',''05SW04'',''05SW05'',''05SW06'',''05SW07'',''05SW08'',''05SW09'',''05SW10'',''05SW11'',''05SW12'',''05SW13'',''05SW14'',''05SW15'',''05SW16'',''05SW17'',''05SW18'',''05SW19'',''05SW20'',''06NW01'',''06NW02'',''06NW03'',''06NW04'',''06NW05'',''06NW06'',''06NW10'',''06NW11'',''06NW12'',''06NW13'',''06NW14'',''06NW16'',''06NW17'',''06NW18'',''06NW19'',''06NW20'',''06NW21'',''06NW22'',''06NW23'',''06NW24'',''06NW25'',''06NW26'',''06SW01'',''06SW02'',''06SW03'',''06SW04'',''06SW05'',''06SW06'',''06SW07'',''06SW08'',''06SW09'',''06SW10'',''06SW11'',''06SW12'',''06SW13'',''06SW14'',''06SW15'',''06SW16'',''06SW17'',''06SW18'',''06SW19'',''06SW20'',''06SW21'',''06SW22'',''06SW23'',''06SW24'',''06SW25'',''06SW26'',''06SW27'',''06SW28'',''06SW29'',''06SW30'',''06SW31'',''07NW01'',''07NW02'',''07NW03'',''07NW04'',''07NW05'',''07NW06'',''07NW14'',''07NW16'',''07NW17'',''07NW18'',''07NW19'',''07NW20'',''07NW21'',''07NW22'',''07NW23'',''07NW24'',''07NW25'',''07NW26'',''07SW01'',''07SW02'',''07SW03'',''07SW04'',''07SW05'',''07SW06'',''07SW07'',''07SW08'',''07SW09'',''07SW10'',''07SW11'',''07SW12'',''07SW13'',''07SW14'',''07SW15'',''07SW16'',''07SW17'',''07SW18'',''07SW19'',''07SW20'',''07SW21'',''07SW22'',''07SW23'',''07SW24'',''07SW25'',''07SW26'',''07SW27'',''07SW28'',''07SW29'',''07SW30'',''07SW31'',''08NW01'',''08NW02'',''08NW03'',''08NW04'',''08NW05'',''08NW06'',''08NW11'',''08NW14'',''08NW16'',''08NW17'',''08NW18'',''08NW19'',''08NW20'',''08NW21'',''08NW22'',''08NW23'',''08NW24'',''08NW25'',''08NW26'',''08SW01'',''08SW02'',''08SW03'',''08SW04'',''08SW05'',''08SW06'',''08SW07'',''08SW08'',''08SW09'',''08SW10'',''08SW11'',''08SW12'',''08SW13'',''08SW14'',''08SW15'',''08SW16'',''08SW17'',''08SW18'',''08SW19'',''08SW20'',''08SW21'',''08SW22'',''08SW23'',''08SW24'',''08SW25'',''08SW26'',''08SW27'',''08SW28'',''08SW29'',''08SW30'',''08SW31'',''09NW01'',''09NW02'',''09NW03'',''09NW04'',''09NW05'',''09NW06'',''09NW11'',''09NW13'',''09NW14'',''09NW16'',''09NW17'',''09NW18'',''09NW19'',''09NW20'',''09NW21'',''09NW22'',''09NW23'',''09NW24'',''09NW25'',''09NW26'',''09SW01'',''09SW02'',''09SW03'',''09SW04'',''09SW05'',''09SW06'',''09SW07'',''09SW08'',''09SW09'',''09SW10'',''09SW11'',''09SW12'',''09SW13'',''09SW14'',''09SW15'',''09SW16'',''09SW17'',''09SW18'',''09SW19'',''09SW20'',''09SW21'',''09SW22'',''09SW23'',''09SW24'',''09SW25'',''09SW26'',''09SW27'',''09SW28'',''09SW29'',''09SW30'',''09SW31'',''10NW01'',''10NW02'',''10NW03'',''10NW04'',''10NW05'',''10NW06'',''10NW10'',''10NW13'',''10NW14'',''10NW15'',''10NW16'',''10NW17'',''10NW18'',''10NW19'',''10NW20'',''10NW21'',''10NW22'',''10NW23'',''10NW24'',''10NW25'',''10NW26'',''10SW01'',''10SW02'',''10SW03'',''10SW04'',''10SW05'',''10SW08'',''10SW09'',''10SW10'',''10SW11'',''10SW12'',''10SW13'',''10SW14'',''10SW15'',''10SW16'',''10SW17'',''10SW18'',''10SW19'',''10SW20'',''10SW21'',''10SW22'',''10SW23'',''10SW24'',''10SW25'',''10SW26'',''10SW27'',''10SW28'',''10SW29'',''10SW30'',''10SW31'',''11NW01'',''11NW02'',''11NW03'',''11NW04'',''11NW05'',''11NW06'',''11NW14'',''11NW16'',''11NW17'',''11NW18'',''11NW19'',''11NW20'',''11NW21'',''11NW22'',''11NW23'',''11NW24'',''11NW25'',''11NW26'',''11SW01'',''11SW02'',''11SW03'',''11SW04'',''11SW05'',''11SW08'',''11SW09'',''11SW10'',''11SW11'',''11SW12'',''11SW13'',''11SW14'',''11SW15'',''11SW16'',''11SW17'',''11SW18'',''11SW19'',''11SW20'',''11SW21'',''11SW22'',''11SW23'',''11SW24'',''11SW25'',''11SW26'',''11SW27'',''11SW28'',''11SW29'',''11SW30'',''11SW31'',''12ANW01'',''12ANW02'',''12ANW03'',''12ANW04'',''12ANW05'',''12ANW06'',''12ANW16'',''12ANW17'',''12ANW18'',''12ANW19'',''12ANW20'',''12ANW21'',''12ANW22'',''12ANW23'',''12ANW24'',''12ANW25'',''12ANW26'',''12ASW02'',''12ASW10'',''12ASW11'',''12ASW12'',''12ASW13'',''12ASW14'',''12ASW15'',''12ASW16'',''12ASW17'',''12ASW18'',''12ASW19'',''12ASW20'',''12ASW21'',''12ASW22'',''12ASW23'',''12ASW24'',''12ASW25'',''12ASW26'',''12ASW27'',''12ASW28'',''12ASW29'',''12ASW30'',''12ASW31'',''12NW01'',''12NW02'',''12NW03'',''12NW04'',''12NW05'',''12NW06'',''12NW11'',''12NW12'',''12NW13'',''12NW14'',''12NW16'',''12NW17'',''12NW18'',''12NW19'',''12NW20'',''12NW21'',''12NW22'',''12NW23'',''12NW24'',''12NW25'',''12NW26'',''12SW01'',''12SW02'',''12SW03'',''12SW04'',''12SW05'',''12SW09'',''12SW10'',''12SW11'',''12SW12'',''12SW13'',''12SW14'',''12SW15'',''12SW16'',''12SW17'',''12SW18'',''12SW19'',''12SW20'',''12SW21'',''12SW22'',''12SW23'',''12SW24'',''12SW25'',''12SW26'',''12SW27'',''12SW28'',''12SW29'',''12SW30'',''12SW31'',''14NW01'',''14NW02'',''14NW03'',''14NW04'',''14NW05'',''14NW06'',''14NW09'',''14NW12'',''14NW14'',''14NW16'',''14NW17'',''14NW18'',''14NW19'',''14NW20'',''14NW21'',''14NW22'',''14NW23'',''14NW24'',''14NW25'',''14NW26'',''14SW01'',''14SW02'',''14SW03'',''14SW04'',''14SW05'',''14SW06'',''14SW10'',''14SW11'',''14SW12'',''14SW13'',''14SW14'',''14SW15'',''14SW16'',''14SW17'',''14SW18'',''14SW19'',''14SW20'',''14SW21'',''14SW22'',''14SW23'',''14SW24'',''14SW25'',''14SW26'',''14SW27'',''14SW28'',''14SW29'',''14SW30'',''14SW31'',''15NW01'',''15NW02'',''15NW03'',''15NW04'',''15NW05'',''15NW06'',''15NW09'',''15NW10'',''15NW11'',''15NW12'',''15NW14'',''15NW16'',''15NW17'',''15NW18'',''15NW19'',''15NW20'',''15NW21'',''15NW22'',''15NW23'',''15NW24'',''15NW25'',''15NW26'',''15SW01'',''15SW02'',''15SW03'',''15SW04'',''15SW05'',''15SW08'',''15SW09'',''15SW10'',''15SW11'',''15SW12'',''15SW13'',''15SW14'',''15SW15'',''15SW16'',''15SW17'',''15SW18'',''15SW19'',''15SW20'',''15SW21'',''15SW22'',''15SW23'',''15SW24'',''15SW25'',''15SW26'',''15SW27'',''15SW28'',''15SW29'',''15SW30'',''15SW31'',''16NW01'',''16NW02'',''16NW03'',''16NW04'',''16NW05'',''16NW06'',''16NW16'',''16NW17'',''16NW18'',''16NW19'',''16NW20'',''16NW21'',''16NW23'',''16NW24'',''16NW25'',''16NW26'',''16SW01'',''16SW02'',''16SW03'',''16SW04'',''16SW05'',''16SW09'',''16SW10'',''16SW11'',''16SW12'',''16SW13'',''16SW14'',''16SW15'',''16SW16'',''16SW17'',''16SW18'',''16SW19'',''16SW20'',''16SW21'',''16SW22'',''16SW23'',''16SW25'',''16SW26'',''16SW27'',''16SW28'',''16SW29'',''16SW30'',''16SW31'',''17NW01'',''17NW02'',''17NW03'',''17NW04'',''17NW05'',''17NW06'',''17NW09'',''17NW12'',''17NW14'',''17NW16'',''17NW17'',''17NW18'',''17NW19'',''17NW20'',''17NW21'',''17NW23'',''17NW24'',''17NW25'',''17NW26'',''17SW03'',''17SW04'',''17SW05'',''17SW09'',''17SW10'',''17SW11'',''17SW12'',''17SW13'',''17SW14'',''17SW15'',''17SW16'',''17SW17'',''17SW18'',''17SW19'',''17SW20'',''17SW21'',''17SW22'',''17SW23'',''17SW25'',''17SW26'',''17SW27'',''17SW28'',''17SW29'',''17SW30'',''17SW31'',''18NW01'',''18NW02'',''18NW03'',''18NW04'',''18NW05'',''18NW06'',''18NW16'',''18NW17'',''18NW18'',''18NW19'',''18NW20'',''18NW21'',''18NW22'',''18NW23'',''18NW24'',''18NW25'',''18NW26'',''18SW03'',''18SW04'',''18SW07'',''18SW09'',''18SW10'',''18SW11'',''18SW12'',''18SW13'',''18SW14'',''18SW15'',''18SW16'',''18SW17'',''18SW18'',''18SW19'',''18SW20'',''18SW21'',''18SW22'',''18SW23'',''18SW25'',''18SW26'',''18SW27'',''18SW28'',''18SW29'',''18SW30'',''18SW31'',''19NW01'',''19NW02'',''19NW03'',''19NW04'',''19NW05'',''19NW06'',''19NW13'',''19NW16'',''19NW17'',''19NW18'',''19NW19'',''19NW20'',''19NW21'',''19NW23'',''19NW24'',''19NW25'',''19NW26'',''19SW03'',''19SW04'',''19SW05'',''19SW09'',''19SW10'',''19SW11'',''19SW12'',''19SW13'',''19SW14'',''19SW15'',''19SW16'',''19SW17'',''19SW18'',''19SW19'',''19SW20'',''19SW21'',''19SW22'',''19SW23'',''19SW25'',''19SW26'',''19SW27'',''19SW28'',''19SW29'',''19SW30'',''19SW31'',''20NW01'',''20NW02'',''20NW03'',''20NW04'',''20NW05'',''20NW06'',''20NW16'',''20NW17'',''20NW18'',''20NW19'',''20NW20'',''20NW21'',''20NW23'',''20NW24'',''20NW25'',''20NW26'',''20SW01'',''20SW05'',''20SW09'',''20SW10'',''20SW11'',''20SW12'',''20SW13'',''20SW14'',''20SW15'',''20SW16'',''20SW17'',''20SW18'',''20SW19'',''20SW20'',''20SW21'',''20SW22'',''20SW23'',''20SW25'',''20SW26'',''20SW27'',''20SW28'',''20SW29'',''20SW30'',''20SW31'',''21NW01'',''21NW02'',''21NW03'',''21NW04'',''21NW05'',''21NW06'',''21NW16'',''21NW17'',''21NW18'',''21NW19'',''21NW20'',''21NW21'',''21NW23'',''21NW24'',''21NW25'',''21NW26'',''21SW04'',''21SW05'',''21SW10'',''21SW11'',''21SW12'',''21SW13'',''21SW14'',''21SW15'',''21SW16'',''21SW17'',''21SW18'',''21SW19'',''21SW20'',''21SW21'',''21SW22'',''21SW23'',''21SW25'',''21SW26'',''21SW27'',''21SW28'',''21SW29'',''21SW30'',''21SW31'',''22NW01'',''22NW02'',''22NW03'',''22NW04'',''22NW05'',''22NW06'',''22NW09'',''22NW16'',''22NW18'',''22NW24'',''22NW25'',''22NW26'',''22SW03'',''22SW04'',''22SW05'',''22SW09'',''22SW10'',''22SW11'',''22SW12'',''22SW13'',''22SW14'',''22SW15'',''22SW16'',''22SW17'',''22SW18'',''22SW19'',''22SW20'',''22SW21'',''22SW22'',''22SW26'',''22SW28'',''22SW29'',''22SW30'',''22SW31'',''23NW01'',''23NW02'',''23NW03'',''23NW04'',''23NW05'',''23NW06'',''23NW09'',''23NW16'',''23NW24'',''23NW25'',''23NW26'',''23SW01'',''23SW03'',''23SW04'',''23SW05'',''23SW07'',''23SW10'',''23SW11'',''23SW12'',''23SW13'',''23SW14'',''23SW15'',''23SW16'',''23SW17'',''23SW18'',''23SW19'',''23SW20'',''23SW23'',''23SW26'',''23SW27'',''23SW28'',''23SW29'',''23SW30'',''23SW31'',''24NW01'',''24NW02'',''24NW03'',''24NW04'',''24NW05'',''24NW06'',''24NW14'',''24NW16'',''24NW19'',''24NW24'',''24NW25'',''24NW26'',''24SW02'',''24SW04'',''24SW05'',''24SW06'',''24SW08'',''24SW10'',''24SW11'',''24SW12'',''24SW13'',''24SW14'',''24SW15'',''24SW16'',''24SW17'',''24SW18'',''24SW19'',''24SW20'',''24SW22'',''24SW25'',''24SW26'',''24SW27'',''24SW28'',''24SW29'',''24SW30'',''24SW31'',''25NW01'',''25NW02'',''25NW03'',''25NW04'',''25NW05'',''25NW06'',''25NW16'',''25NW24'',''25NW25'',''25NW26'',''25SW01'',''25SW03'',''25SW05'',''25SW06'',''25SW10'',''25SW11'',''25SW12'',''25SW13'',''25SW14'',''25SW15'',''25SW16'',''25SW17'',''25SW18'',''25SW19'',''25SW20'',''25SW21'',''25SW25'',''25SW26'',''25SW27'',''25SW28'',''25SW29'',''25SW30'',''25SW31'',''26NW01'',''26NW02'',''26NW03'',''26NW04'',''26NW05'',''26NW06'',''26NW16'',''26NW24'',''26NW25'',''26NW26'',''26SW02'',''26SW03'',''26SW04'',''26SW05'',''26SW10'',''26SW11'',''26SW12'',''26SW13'',''26SW14'',''26SW15'',''26SW16'',''26SW17'',''26SW18'',''26SW19'',''26SW20'',''26SW21'',''26SW25'',''26SW26'',''26SW28'',''26SW29'',''26SW30'',''26SW31'',''27NW01'',''27NW02'',''27NW03'',''27NW04'',''27NW05'',''27NW06'',''27NW11'',''27NW14'',''27NW16'',''27NW24'',''27NW25'',''27NW26'',''28NW01'',''28NW02'',''28NW03'',''28NW04'',''28NW05'',''28NW06'',''28NW08'',''28NW09'',''28NW11'',''28NW15'',''28NW16'',''28NW17'',''28NW18'',''28NW19'',''28NW24'',''28NW25'',''28NW26'',''29NW01'',''29NW02'',''29NW03'',''29NW04'',''29NW05'',''29NW06'',''29NW14'',''29NW15'',''29NW16'',''29NW18'',''29NW23'',''29NW24'',''29NW25'',''29NW26'',''30NW01'',''30NW02'',''30NW03'',''30NW04'',''30NW05'',''30NW06'',''30NW14'',''30NW16'',''30NW23'',''30NW24'',''30NW25'',''30NW26'',''31NW01'',''31NW02'',''31NW03'',''31NW04'',''31NW05'',''31NW06'',''31NW07'',''31NW09'',''31NW10'',''31NW11'',''31NW12'',''31NW13'',''31NW14'',''31NW15'',''31NW16'',''31NW19'',''31NW21'',''31NW23'',''31NW24'',''31NW25'',''31NW26''','Administrator Account','1'
--[dbo].[AP2SP_PrintLabel] '10062','''20c18'',''15c18''','',''
--[dbo].[AP2SP_PrintLabel] '10039','''20c18'',''15c18''','Administrator Account','2'
--[dbo].[AP2SP_PrintLabel] '60016','''A10A113'',''a10a114'',''a10a127'',''a10a129''','Administrator Account','1'

CREATE PROC [dbo].[AP2SP_PrintLabel]
    @ProductID  nvarchar(20),
    @UnitNumber nvarchar(MAX),
	@UserName   nvarchar(40),
	@PrintLabel	nvarchar(4)
AS

DECLARE @A varchar(5)
SET @A = (Select CHARINDEX('''',@UnitNumber)) 

--set @UnitNumber=replace(@UnitNumber,'''','''''')

Declare @sql nvarchar(max)
Set @sql = ' 

	DECLARE @A TABLE(ProductID nvarchar(40),UnitNumber nvarchar(40),FirstName nvarchar(40),LastName nvarchar(40),Flag_Com int,ADDRESS1 nvarchar(40),ADDRESS2 nvarchar(40),ADDRESS3 nvarchar(40),ADDRESS4 nvarchar(40),ADDRESS5 nvarchar(40),ADDRESS6 nvarchar(40))
	INSERT INTO @A
			SELECT	ProductID,UnitNumber,FirstName,LastName,Flag_Com
					,ADDRESS1,ADDRESS2,ADDRESS3,ADDRESS4,ADDRESS5,ADDRESS6
			FROM	AP2SP_For_PrintLable
			WHERE	RowNo < '''+@PrintLabel+''' 
'

Set @sql = @sql+ '
		SELECT  ''ProductID'' = '''' --AG.ProductID
--**************************************************ตรงนี้จะส่งยังไงหนะ*****************************************
				,''UnitNumber'' = '''' --[dbo].[fn_GenUnit_PrintLable](AG.ProductID,AO.ContactID,'''+replace(@UnitNumber,'''','''''')+''')			
--*******************************************************************************************
				, ''FirstName'' = '''' --RTrim(LTrim(AO.FirstName)) AS FirstName
                , ''LastName'' = '''' --AO.LastName
				,Flag_Com = '''' --CASE WHEN CT.HouseID_4 like ''%บริษัท%'' OR CT.Village_4 like ''%บริษัท%'' THEN 1 ELSE 0 END
				,ADDRESS1 =	'''' --CASE WHEN ISNULL(CT.HouseID_4,'''') = '''' OR ISNULL(CT.HouseID_4,'''') = ''-'' THEN '''' ELSE CT.HouseID_4 END+
							--CASE WHEN ISNULL(CT.Moo_4,'''') = '''' OR ISNULL(CT.Moo_4,'''') = ''-'' THEN '''' ELSE '' ม. ''+CT.Moo_4 END+''  ''+
							--CASE WHEN ISNULL(CT.Village_4,'''') = '''' OR ISNULL(CT.Village_4,'''') = ''-'' THEN '''' ELSE CT.Village_4 END+''  ''+
							--CASE WHEN ISNULL(CT.Soi_4,'''') = '''' OR ISNULL(CT.Soi_4,'''') = ''-'' THEN '''' ELSE '' ซ. ''+CT.Soi_4 END+''  ''+ 
							--CASE WHEN ISNULL(CT.Road_4,'''') = '''' OR ISNULL(CT.Road_4,'''') = ''-'' THEN '''' ELSE ''ถ.''+CT.Road_4 END
				,ADDRESS2 = '''' --CASE WHEN ISNULL(CT.SubDistrict_4,'''') = '''' OR ISNULL(CT.SubDistrict_4,'''') = ''-'' THEN '''' ELSE ''ตำบล/แขวง ''+CT.SubDistrict_4 END+''  ''+
							--CASE WHEN ISNULL(CT.District_4,'''') = '''' OR ISNULL(CT.District_4,'''') = ''-'' THEN '''' ELSE ''อำเภอ/เขต ''+CT.District_4 END
				,ADDRESS3 = '''' --CASE WHEN ISNULL(CT.Province_4,'''') = '''' OR ISNULL(CT.Province_4,'''') = ''-'' THEN '''' ELSE ''จังหวัด ''+CT.Province_4 END+''  ''+
							--ISNULL(CT.PostalCode_4,'''')
				,ADDRESS4 =	'''' --CASE WHEN ISNULL(CT.HouseID_4,'''') = '''' OR ISNULL(CT.HouseID_4,'''') = ''-'' THEN '''' ELSE CT.HouseID_4 END+''  ''+
							--CASE WHEN ISNULL(CT.Moo_4,'''') = '''' OR ISNULL(CT.Moo_4,'''') = ''-'' THEN '''' ELSE '' ม. ''+CT.Moo_4 END+''  ''+
							--CASE WHEN ISNULL(CT.Village_4,'''') = '''' OR ISNULL(CT.Village_4,'''') = ''-'' THEN '''' ELSE CT.Village_4 END+''  ''+
							--CASE WHEN ISNULL(CT.Soi_4,'''') = '''' OR ISNULL(CT.Soi_4,'''') = ''-'' THEN '''' ELSE '' ซ. ''+CT.Soi_4 END 
				,ADDRESS5 = '''' --CASE WHEN ISNULL(CT.Road_4,'''') = '''' OR ISNULL(CT.Road_4,'''') = ''-'' THEN '''' ELSE ''ถ.''+CT.Road_4 END+''  ''+
							--CASE WHEN ISNULL(CT.SubDistrict_4,'''') = '''' OR ISNULL(CT.SubDistrict_4,'''') = ''-'' THEN '''' ELSE ''ตำบล/แขวง ''+CT.SubDistrict_4 END
				,ADDRESS6 = '''' --CASE WHEN ISNULL(CT.District_4,'''') = '''' OR ISNULL(CT.District_4,'''') = ''-'' THEN '''' ELSE ''อำเภอ/เขต ''+CT.District_4 END+''  ''+
							--CASE WHEN ISNULL(CT.Province_4,'''') = '''' OR ISNULL(CT.Province_4,'''') = ''-'' THEN '''' ELSE ''จังหวัด ''+CT.Province_4 END+''  ''+
							--ISNULL(CT.PostalCode_4,'''')

		FROM [SAL].[Agreement] AG 
			 LEFT OUTER JOIN [SAL].[AgreementOwner] AO ON AO.ContractNumber = AG.ContractNumber AND ISNULL(AO.isMainOwner,0) = ''1'' AND ISNULL(AO.IsDeleted,0) = 0
			 LEFT OUTER JOIN [CTM].[Contact] CT ON CT.ContactID = AO.ContactID
		WHERE	AG.CancelDate IS NULL 
'

		if(Isnull(@ProductID,'')<>'')set @sql=@sql+' and(AG.ProductID = '''+@ProductID+''')'
		if(Isnull(@UnitNumber,'')<>'' And (@UnitNumber <> '''ทั้งหมด''') And (@A >= 1)) set @sql=@sql+' and(AG.UnitNumber IN ('+@UnitNumber+'))' 
		if(Isnull(@UnitNumber,'')<>'' And (@UnitNumber <> '''ทั้งหมด''') And (@A <= 0)) set @sql=@sql+' and(AG.UnitNumber = '''+@UnitNumber+''')'

		set @sql=@sql+' Group By AG.ProductID,AO.ContactID,RTrim(LTrim(AO.FirstName)),AO.LastName,CT.HouseID_4,CT.Village_4
						,CT.Moo_4,CT.Soi_4,CT.Road_4,CT.SubDistrict_4,CT.District_4,CT.Province_4,CT.PostalCode_4 '
		set @sql=@sql+'
			UNION ALL
			SELECT	ProductID,UnitNumber,FirstName,LastName,Flag_Com
					,ADDRESS1,ADDRESS2,ADDRESS3,ADDRESS4,ADDRESS5,ADDRESS6
			FROM	@A 
			'
		set @sql=@sql+' ORDER BY AG.ProductID,UnitNumber ' 
		exec(@sql)
		Print(@sql)

GO
